# Dashi Data Models

## Core Application Entities / Domain Objects

This document defines the main entities and data models used in the Dashi food delivery platform.

### User

- **Description:** Represents users of the platform (Customers, Restaurant staff, Administrators)
- **Schema / Interface Definition:**

  ```typescript
  // Generated by Copilot
  export enum Role {
    CUSTOMER = "CUSTOMER",
    RESTAURANT = "RESTAURANT",
    ADMIN = "ADMIN",
  }

  export interface User {
    id: string; // Unique identifier
    email: string; // Email address for login
    password: string; // Hashed password
    role: Role; // User role
    name?: string; // Optional name
    createdAt: Date; // When the user was created
    updatedAt: Date; // When the user was last updated
  }
  ```

- **Validation Rules:**
  - Email must be a valid email format
  - Password must be securely hashed (bcrypt)
  - Role must be one of the defined enum values

### Restaurant

- **Description:** Represents a food establishment offering items on the platform
- **Schema / Interface Definition:**
  ```typescript
  // Generated by Copilot
  export interface Restaurant {
    id: string; // Unique identifier
    name: string; // Restaurant name
    description?: string; // Optional restaurant description
    contactInfo?: string; // Contact information (phone, email)
    serviceArea?: string; // Description of delivery area
    createdAt: Date; // When the restaurant was created
    updatedAt: Date; // When the restaurant was last updated
    isDeleted: boolean; // Soft delete flag
    ownerId?: string; // ID of the restaurant user who manages this restaurant
  }
  ```
- **Validation Rules:**
  - Name must be between 2 and 100 characters
  - Contact information should include a valid phone number or email

### MenuItem

- **Description:** Represents a food or beverage item offered by a restaurant
- **Schema / Interface Definition:**
  ```typescript
  // Generated by Copilot
  export interface MenuItem {
    id: string; // Unique identifier
    restaurantId: string; // ID of the restaurant this item belongs to
    name: string; // Item name
    description?: string; // Optional item description
    category?: string; // Category for grouping items
    price: number; // Price in local currency
    isAvailable: boolean; // Whether the item is currently available
    createdAt: Date; // When the item was created
    updatedAt: Date; // When the item was last updated
    isDeleted: boolean; // Soft delete flag
  }
  ```
- **Validation Rules:**
  - Name must be between 2 and 100 characters
  - Price must be a positive number
  - Category should be between 2 and 50 characters if provided

### Order

- **Description:** Represents a customer's order from a restaurant
- **Schema / Interface Definition:**

  ```typescript
  // Generated by Copilot
  export enum OrderStatus {
    NEW = "NEW",
    PREPARING = "PREPARING",
    READY_FOR_DELIVERY = "READY_FOR_DELIVERY",
    COMPLETED = "COMPLETED", // Future state
    CANCELLED = "CANCELLED", // Future state
  }

  export interface Order {
    id: string; // Unique identifier
    customerId: string; // ID of the customer who placed the order
    restaurantId: string; // ID of the restaurant fulfilling the order
    customerNotes?: string; // Delivery address/notes
    totalAmount: number; // Total order amount
    status: OrderStatus; // Current order status
    createdAt: Date; // When the order was placed
    updatedAt: Date; // When the order was last updated
  }
  ```

- **Validation Rules:**
  - Total amount must be a positive number
  - Status must be one of the defined enum values
  - Customer notes should not exceed 500 characters

### OrderItem

- **Description:** Represents an individual item within an order
- **Schema / Interface Definition:**
  ```typescript
  // Generated by Copilot
  export interface OrderItem {
    id: string; // Unique identifier
    orderId: string; // ID of the parent order
    menuItemId: string; // ID of the ordered menu item
    quantity: number; // Quantity ordered
    priceAtOrder: number; // Price at the time of order
  }
  ```
- **Validation Rules:**
  - Quantity must be a positive integer
  - Price at order must be a positive number

## API Payload Schemas

### Place Order Request

- **Description:** Payload for placing a new order
- **Schema / Interface Definition:**
  ```typescript
  // Generated by Copilot
  export interface PlaceOrderRequest {
    restaurantId: string; // ID of the restaurant
    items: {
      menuItemId: string; // ID of the menu item
      quantity: number; // Quantity to order
    }[];
    customerNotes?: string; // Delivery address/notes
  }
  ```
- **Validation Rules:**
  - Must include at least one item
  - Each item quantity must be a positive integer
  - Customer notes should not exceed 500 characters

### Update Order Status Request

- **Description:** Payload for updating an order's status
- **Schema / Interface Definition:**
  ```typescript
  // Generated by Copilot
  export interface UpdateOrderStatusRequest {
    orderId: string; // ID of the order to update
    status: OrderStatus; // New status value
  }
  ```

## Database Schema (Prisma)

The Dashi platform uses Prisma ORM with PostgreSQL. Below is the Prisma schema definition for the core entities.

```prisma
// Generated by Copilot
enum Role {
  CUSTOMER
  RESTAURANT
  ADMIN
}

model User {
  id        String    @id @default(cuid())
  email     String    @unique
  password  String
  role      Role      @default(CUSTOMER)
  name      String?
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt

  // Relations
  restaurant Restaurant? @relation("RestaurantUser")
  orders     Order[]
}

model Restaurant {
  id          String    @id @default(cuid())
  name        String
  description String?
  contactInfo String?
  serviceArea String?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  isDeleted   Boolean   @default(false)

  // Relations
  owner       User?     @relation("RestaurantUser", fields: [ownerId], references: [id])
  ownerId     String?   @unique
  menuItems   MenuItem[]
  orders      Order[]
}

model MenuItem {
  id          String    @id @default(cuid())
  name        String
  description String?
  category    String?
  price       Float
  isAvailable Boolean   @default(true)
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  isDeleted   Boolean   @default(false)

  // Relations
  restaurant   Restaurant @relation(fields: [restaurantId], references: [id])
  restaurantId String
  orderItems   OrderItem[]
}

enum OrderStatus {
  NEW
  PREPARING
  READY_FOR_DELIVERY
  COMPLETED
  CANCELLED
}

model Order {
  id            String      @id @default(cuid())
  customerNotes String?
  totalAmount   Float
  status        OrderStatus @default(NEW)
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt

  // Relations
  customer      User        @relation(fields: [customerId], references: [id])
  customerId    String
  restaurant    Restaurant  @relation(fields: [restaurantId], references: [id])
  restaurantId  String
  orderItems    OrderItem[]
}

model OrderItem {
  id          String @id @default(cuid())
  quantity    Int
  priceAtOrder Float

  // Relations
  order       Order    @relation(fields: [orderId], references: [id])
  orderId     String
  menuItem    MenuItem @relation(fields: [menuItemId], references: [id])
  menuItemId  String
}
```

## Frontend State Models

### Cart State

- **Description:** Represents the shopping cart state in the frontend
- **Schema / Interface Definition:**
  ```typescript
  // Generated by Copilot
  export interface CartState {
    restaurantId: string | null; // ID of the restaurant items are from
    items: {
      menuItemId: string; // ID of menu item
      name: string; // Name of menu item
      price: number; // Price of menu item
      quantity: number; // Quantity selected
    }[];
    subtotal: number; // Calculated subtotal
  }
  ```

### Language Preference

- **Description:** Tracks the user's selected language preference
- **Format:** Browser localStorage
- **Schema Definition:**
  ```typescript
  // Generated by Copilot
  export interface LanguagePreference {
    language: "en" | "fr"; // English or French
  }
  ```

## Change Log

| Change        | Date       | Version | Description                            | Author         |
| ------------- | ---------- | ------- | -------------------------------------- | -------------- |
| Initial draft | 2025-05-05 | 0.1     | Initial data models for Dashi platform | GitHub Copilot |

<!-- Generated by Copilot -->
